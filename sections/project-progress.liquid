{%- if section.settings.fullwidth -%}
	{%- assign container = 'container-full' -%}
{%- elsif section.settings.max_width != blank -%}
	{%- assign container = 'kretoss-container' -%}
{%- else -%}
	{%- assign container = 'page-width' -%}
{%- endif -%}

{%- assign max_width = '' -%}
{%- if section.settings.fullwidth == blank and section.settings.max_width != blank -%}
	{%- assign width_container = section.settings.max_width | plus: 0 -%}
	{%- capture max_width -%}style="max-width: {{ section.settings.max_width }};"{%- endcapture -%}
{%- endif -%}

{% assign margin 	= section.settings.margin | split: "|" %}
{% assign padding 	= section.settings.padding | split: "|" %}
{%- style -%}
  {%- if margin[0] != blank or padding[0] != blank -%}
		#shopify-section-{{ section.id }} .section-project_progress_data{
			{%- if margin[0] != blank -%}margin: {{ margin[0] }};{%- endif -%}
			{%- if padding[0] != blank -%}padding:{{ padding[0] }};{%- endif -%}
		}
	{%- endif -%}
	{%- if margin[1] != blank or padding[1] != blank -%}
		@media (max-width:1200px){
			#shopify-section-{{ section.id }} .section-project_progress_data{
				{%- if margin[1] != blank -%}margin: {{ margin[1] }};{%- endif -%}
				{%- if padding[1] != blank -%}padding:{{ padding[1] }};{%- endif -%}
			}
		}
	{%- endif -%}
	{%- if margin[2] != blank or padding[2] != blank -%}
		@media (max-width:991px){
			#shopify-section-{{ section.id }} .section-project_progress_data{
				{%- if margin[2] != blank -%}margin: {{ margin[2] }};{%- endif -%}
				{%- if padding[2] != blank -%}padding:{{ padding[2] }};{%- endif -%}
			}
		}
	{%- endif -%}
	{%- if margin[3] != blank or padding[3] != blank -%}
		@media (max-width:767px){
			#shopify-section-{{ section.id }} .section-project_progress_data{
				{%- if margin[3] != blank -%}margin: {{ margin[3] }};{%- endif -%}
				{%- if padding[3] != blank -%}padding:{{ padding[3] }};{%- endif -%}
			}
		}
	{%- endif -%}



{%- endstyle -%}

<div class="kretoss-section section-project_progress_data">
	<div class="{{ container }}" {{ max_width }}>
        <div class="project_progress_inner">
            <div class="project_progress_left">
                {% assign raised_amount = product.metafields.custom.raised_amount | default: 0 %}
                {% assign goal_amount = product.metafields.custom.project_goal | default: 1 %}
                {% assign progress = raised_amount | times: 100.0 | divided_by: goal_amount | round: 2 %}
                {% if progress > 100 %}
                    {% assign progress = 100 %}
                {% endif %}

                {% assign bar_width = progress %}
                {% if bar_width < 2 %}
                    {% assign bar_width = 2 %}
                {% endif %}

                {% assign raised = raised_amount | times: 1.0 %}
                {% if raised >= 10000000 %}
                    {% assign raised_display = raised | divided_by: 10000000.0 | round: 2 | append: 'Cr' %}
                {% elsif raised >= 100000 %}
                    {% assign raised_display = raised | divided_by: 100000.0 | round: 1 | append: 'L' %}
                {% else %}
                    {% assign raised_display = raised | money_without_currency %}
                {% endif %}

                {% assign goal = goal_amount | times: 1.0 %}
                {% if goal >= 10000000 %}
                    {% assign goal_display = goal | divided_by: 10000000.0 | round: 2 | append: 'Cr' %}
                {% elsif goal >= 100000 %}
                    {% assign goal_display = goal | divided_by: 100000.0 | round: 1 | append: 'L' %}
                {% else %}
                    {% assign goal_display = goal | money_without_currency %}
                {% endif %}

                <div class="goal_progress">
                    <div class="progress_data">
                        <div class="goal_raised">
                            <h2>₹ {{ raised_display }}</h2>
                            <span>Raised till now</span>
                        </div>
                        <div class="goal_total">
                            <h2>₹ {{ goal_display }}</h2>
                            <span>Our total goal</span>
                        </div>
                    </div>
                    <div class="raised_progress_bar">
                        <div class="raised_progress_track">
                            <div class="progress_fill" style="width: {{ bar_width }}%;"> </div>
                        </div>
                    </div>
                    <div class="total_raised_percentage">
                        <h3>{{ progress }}%</h3><span>Raised</span>
                    </div>
                    <p class="goal_info">Project activates once we hit <span>75%</span> of the goal. Until then, the project stays in the planning stage. The project stays in the planning stage.</p>
                </div>
            </div>
            <div class="project_progress_right">
            </div>
        </div>
	</div>
</div>

{% schema %}
{
  "name": "Project Progress Data",
  "settings": [
    {
      "type": "header",
      "content": "Layout settings"
    },
    {
      "type": "text",
      "id": "max_width",
      "label": "Width container",
      "info": "Default: 1296px"
    },
    {
      "type": "checkbox",
      "id": "fullwidth",
      "label": "Fullwidth"
    },
    {
      "type": "text",
      "id": "padding",
      "label": "Padding",
      "placeholder": "0px 0px 0px 0px",
      "info":"Screen: desktop | 1200px | 991px | 767px"
    },
    {
      "type": "text",
      "id": "margin",
      "label": "Margin",
      "placeholder": "0px 0px 0px 0px",
      "info":"Screen: desktop | 1200px | 991px | 767px"
    }
  ],
	"presets": [
		{
			"name": "Project Progress Data"
		}
    ]
}
{% endschema %}