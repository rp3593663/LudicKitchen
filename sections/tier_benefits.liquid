{%- if section.settings.fullwidth -%}
  {%- assign container = 'container-full' -%}
{%- elsif section.settings.max_width != blank -%}
  {%- assign container = 'kretoss-container' -%}
{%- else -%}
  {%- assign container = 'page-width' -%}
{%- endif -%}

{%- assign max_width = '' -%}
{%- if section.settings.fullwidth == blank and section.settings.max_width != blank -%}
  {%- capture max_width -%}style="max-width: {{ section.settings.max_width }};"{%- endcapture -%}
{%- endif -%}

{% assign margin  = section.settings.margin | split: "|" %}
{% assign padding = section.settings.padding | split: "|" %}

{%- style -%}
#shopify-section-{{ section.id }} .section-project_tier_benefits{
  {% if margin[0] != blank %}margin: {{ margin[0] }};{% endif %}
  {% if padding[0] != blank %}padding: {{ padding[0] }};{% endif %}
}
@media (max-width:1200px){
  #shopify-section-{{ section.id }} .section-project_tier_benefits{
    {% if margin[1] != blank %}margin: {{ margin[1] }};{% endif %}
    {% if padding[1] != blank %}padding: {{ padding[1] }};{% endif %}
  }
}
@media (max-width:991px){
  #shopify-section-{{ section.id }} .section-project_tier_benefits{
    {% if margin[2] != blank %}margin: {{ margin[2] }};{% endif %}
    {% if padding[2] != blank %}padding: {{ padding[2] }};{% endif %}
  }
}
@media (max-width:767px){
  #shopify-section-{{ section.id }} .section-project_tier_benefits{
    {% if margin[3] != blank %}margin: {{ margin[3] }};{% endif %}
    {% if padding[3] != blank %}padding: {{ padding[3] }};{% endif %}
  }
}

.more_info_block{display:none;}
.more_info{cursor:pointer;font-weight:600;}
{%- endstyle -%}

<div class="kretoss-section section-project_tier_benefits">
  <div class="{{ container }}" {{ max_width }}>

    <table class="tier_benefits_inner">
      <thead>
        <tr>
          <th></th>
          <th><h2>{{ section.settings.tier_1 }}</h2></th>
          <th><h2>{{ section.settings.tier_2 }}</h2></th>
          <th><h2>{{ section.settings.tier_3 }}</h2></th>
        </tr>
      </thead>

      <tbody>
        {% for block in section.blocks %}
          <tr {{ block.shopify_attributes }}>
            <!-- BENEFIT -->
            <td class="tier_features">
              <div class="features_info">
                <h4>{{ block.settings.title }}</h4>
                <div class="description">
                  {{ block.settings.short_text }}
                  {% if block.settings.more_text != blank %}
                    <span class="more_info"> Learn More</span>
                    <div class="more_info_block">
                      {{ block.settings.more_text }}
                    </div>
                  {% endif %}
                </div>
              </div>
            </td>

            <!-- TIER 1 -->
            <td class="tier_benefit_yes_no">
              <img
                src="{% if block.settings.tier_1 %}{{ section.settings.icon_yes }}{% else %}{{ section.settings.icon_no }}{% endif %}"
                alt="tier-1"
              >
            </td>

            <!-- TIER 2 -->
            <td class="tier_benefit_yes_no">
              <img
                src="{% if block.settings.tier_2 %}{{ section.settings.icon_yes }}{% else %}{{ section.settings.icon_no }}{% endif %}"
                alt="tier-2"
              >
            </td>

            <!-- TIER 3 -->
            <td class="tier_benefit_yes_no">
              <img
                src="{% if block.settings.tier_3 %}{{ section.settings.icon_yes }}{% else %}{{ section.settings.icon_no }}{% endif %}"
                alt="tier-3"
              >
            </td>
          </tr>
        {% endfor %}
      </tbody>
    </table>

  </div>
</div>

<script>
document.addEventListener("click", function(e){
  if(e.target.classList.contains("more_info")){
    const block = e.target.nextElementSibling;
    block.style.display = block.style.display === "block" ? "none" : "block";
  }
});
</script>

{% schema %}
{
  "name": "Project Tier Benefits",
  "settings": [
    {
      "type": "header",
      "content": "Layout settings"
    },
    {
      "type": "text",
      "id": "max_width",
      "label": "Width container",
      "info": "Default: 1296px"
    },
    {
      "type": "checkbox",
      "id": "fullwidth",
      "label": "Fullwidth"
    },
    {
      "type": "text",
      "id": "padding",
      "label": "Padding",
      "info": "desktop | 1200px | 991px | 767px"
    },
    {
      "type": "text",
      "id": "margin",
      "label": "Margin",
      "info": "desktop | 1200px | 991px | 767px"
    },
    {
      "type": "text",
      "id": "tier_1",
      "label": "Tier 1 name",
      "default": "Taster"
    },
    {
      "type": "text",
      "id": "tier_2",
      "label": "Tier 2 name",
      "default": "Sous Chef"
    },
    {
      "type": "text",
      "id": "tier_3",
      "label": "Tier 3 name",
      "default": "Head Chef"
    },
    {
      "type": "image_picker",
      "id": "icon_yes",
      "label": "Yes icon"
    },
    {
      "type": "image_picker",
      "id": "icon_no",
      "label": "No icon"
    }
  ],
  "blocks": [
    {
      "type": "benefit",
      "name": "Benefit row",
      "settings": [
        {
          "type": "text",
          "id": "title",
          "label": "Benefit title"
        },
        {
          "type": "text",
          "id": "short_text",
          "label": "Short description"
        },
        {
          "type": "textarea",
          "id": "more_text",
          "label": "Learn more text"
        },
        {
          "type": "checkbox",
          "id": "tier_1",
          "label": "Tier 1"
        },
        {
          "type": "checkbox",
          "id": "tier_2",
          "label": "Tier 2"
        },
        {
          "type": "checkbox",
          "id": "tier_3",
          "label": "Tier 3"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Project Tier Benefits"
    }
  ]
}
{% endschema %}
